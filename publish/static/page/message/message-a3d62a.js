webpackJsonp([6],{55:function(e,t){"use strict";function a(e,t,a){var n="";if(a)n="top";else if(t)n="good";else switch(e){case"share":n="share";break;case"ask":n="ask";break;case"job":n="job";break;default:n="default"}return n}function n(e){var t="";switch(e){case"share":t="分享";break;case"ask":t="问答";break;case"job":t="招聘";break;case"good":t="精华";break;default:t="全部"}return t}function r(e,t,a){var n="";if(a)n="置顶";else if(t)n="精华";else switch(e){case"share":n="分享";break;case"ask":n="问答";break;case"job":n="招聘";break;default:n="暂无"}return n}function s(e,t){return t?u(new Date-new Date(e)):c(new Date(e),"yyyy-MM-dd hh:mm")}function l(e){if(!e)return[];var t=[/```.+?```/g,/^```[\s\S]+?^```/gm,/`[\s\S]+?`/g,/^    .*/gm,/\b\S*?@[^\s]*?\..+?\b/g,/\[@.+?\]\(\/.+?\)/g];t.forEach((function(t){e=e.replace(t,"")}));var a=e.match(/@[a-z0-9\-_]+\b/gim),n=[],r={};if(a)for(var s=0,l=a.length;s<l;s++){var o=a[s];o=o.slice(1),r.hasOwnProperty(o)||(n.push(o),r[o]=!0)}return n}function o(e){for(var t=l(e),a=0,n=t.length;a<n;a++){var r=t[a];e=e.replace(new RegExp("@"+r+"\\b(?!\\])","g"),"[@"+r+"](/user/"+r+")")}return e}function c(e,t){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in a)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return t}function u(e){var t=parseFloat(e)/1e3,a="";return null!=t&&""!=t&&(a=t>60&&t<3600?parseInt(t/60)+" 分钟前":t>=3600&&t<86400?parseInt(t/3600)+" 小时前":t>=86400&&t<2592e3?parseInt(t/86400)+" 天前":t>=2592e3&&t<31536e3?parseInt(t/2592e3)+" 个月前":t>=31536e3?parseInt(t/31536e3)+" 年前":parseInt(t)+" 秒前"),a}Object.defineProperty(t,"__esModule",{value:!0}),t.getTabClassName=a,t.getTitleByTab=n,t.getTabStr=r,t.getLastTimeStr=s,t.fetchUsers=l,t.linkUsers=o,t.fmtDate=c,t.MillisecondToDate=u},98:function(e,t,a){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function n(r,s){try{var l=t[r](s),o=l.value}catch(c){return void a(c)}return l.done?void e(o):Promise.resolve(o).then((function(e){n("next",e)}),(function(e){n("throw",e)}))}return n("next")})}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}})(),i=a(38),f=r(i),d=a(99),p=n(d),h=a(100),m=r(h),g=(function(e){function t(){var e,a,n,r,c=this;l(this,t);for(var u=arguments.length,i=Array(u),f=0;f<u;f++)i[f]=arguments[f];return a=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.KeepAlive=!0,n.NeedLogin=!0,n.Model=p,n.View=m["default"],n.handleTabChange=function(e){var t=e.currentTarget,a=t.getAttribute("data-tab"),r=n.store.actions.CHANGE_TAB;r(a)},n.handleMarkAll=s(regeneratorRuntime.mark((function d(){var e,t;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e="/message/mark_all",t=n.cookie("accesstoken"),a.next=5,n.post(e,{accesstoken:t});case 5:a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),n.showAlert(a.t0.message);case 10:case"end":return a.stop()}}),d,c,[[0,7]])}))),r=a,o(n,r)}return c(t,e),u(t,[{key:"componentWillCreate",value:(function(){function e(){return t.apply(this,arguments)}var t=s(regeneratorRuntime.mark((function a(){var e,t,n,r,s;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e=this.cookie("accesstoken"),t="/messages?accesstoken="+e,a.next=4,this.get(t);case 4:n=a.sent,r=n.data,s=this.store.actions.COMPONENT_WILL_CREATE,s({hasRead:r.has_read_messages,hasNotRead:r.hasnot_read_messages});case 8:case"end":return a.stop()}}),a,this)})));return e})()}]),t})(f["default"]);t["default"]=g},99:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},n=(t.initialState={pageTitle:"消息",tab:"hasNotRead",hasRead:[],hasNotRead:[]},t.COMPONENT_WILL_CREATE=function(e,t){var r=t.hasRead,s=t.hasNotRead,l=s.length>0?"hasNotRead":"hasRead";return e=n(e,l),a({},e,{hasRead:r,hasNotRead:s})},t.CHANGE_TAB=function(e,t){return a({},e,{tab:t})})},100:function(e,t,a){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function s(e){var t=e.state,a=e.handlers,n=t.tab,r=(t.hasRead,t.hasNotRead),s=(0,p["default"])({item:!0,br:!0,selected:"hasRead"===n}),o=(0,p["default"])({item:!0,br:!0,selected:"hasNotRead"===n});return f["default"].createElement(g["default"],null,f["default"].createElement("div",{className:"page"},f["default"].createElement("ul",{className:"tabs"},f["default"].createElement("li",{className:s,"data-tab":"hasRead",onClick:a.handleTabChange},"已读消息"),f["default"].createElement("li",{className:o,"data-tab":"hasNotRead",onClick:a.handleTabChange},"未读消息",r.length>0&&f["default"].createElement("i",{className:"iconfont read",onClick:a.handleMarkAll},""))),f["default"].createElement(l,{list:t[n]})))}function l(e){var t=e.list;return t&&t.length?f["default"].createElement("div",null,t.map((function(e){return f["default"].createElement(c,u({},e,{key:e.id}))}))):f["default"].createElement(o,null)}function o(){return f["default"].createElement("div",{className:"no-data"},f["default"].createElement("i",{className:"iconfont icon-empty"},""),"暂无数据!")}function c(e){var t=(e.id,e.title,e.author),a=e.type,n=e.reply,r=e.topic;return f["default"].createElement("div",{className:"message markdown-body"},f["default"].createElement("section",{className:"user"},f["default"].createElement(h.Link,{as:"img",className:"head",src:t.avatar_url,to:"/user/"+t.loginname}),f["default"].createElement("div",{className:"info"},f["default"].createElement("span",{className:"cl"},f["default"].createElement("span",{className:"name"},t.loginname),"at"===a&&f["default"].createElement("span",{className:"name"},"在回复中@了您"),"reply"===a&&f["default"].createElement("span",{className:"name"},"回复了您的话题")),f["default"].createElement("span",{className:"cr"},f["default"].createElement("span",{className:"name"},v.getLastTimeStr(n.create_at,!0))))),f["default"].createElement("div",{className:"reply_content",dangerouslySetInnerHTML:{__html:n.content}}),f["default"].createElement(h.Link,{className:"topic-title",to:"/topic/"+r.id},"话题：",r.title))}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};t["default"]=s;var i=a(2),f=r(i),d=a(62),p=r(d),h=a(58),m=a(70),g=r(m),b=a(55),v=n(b)}});